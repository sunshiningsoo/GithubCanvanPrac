# workflow Ïùò Ïù¥Î¶Ñ
name: test_on_dev

on:
    # develop Î∏åÎûúÏπòÏóê push ÎÇò pull request Ïù¥Î≤§Ìä∏Í∞Ä ÏùºÏñ¥ÎÇ¨ÏùÑÎïå Ìï¥Îãπ workflow Î•º trigger
    push:
      branches: [ main ]
    pull_request:
      branches: [ main ]

# workflowÏùò Ïã§ÌñâÏùÄ ÌïòÎÇò Ïù¥ÏÉÅÏùò jobÏúºÎ°ú Íµ¨ÏÑ± Îê®
jobs:
    # Ïù¥ workflow Îäî "build" ÎùºÎäî single job ÏúºÎ°ú Íµ¨ÏÑ±
    build:
    # jobÏù¥ Ïã§ÌñâÎê† ÌôòÍ≤Ω - ÏµúÏã† mac os
      runs-on: macos-latest
    
    # StepÏùÄ jobÏùò ÏùºÎ∂ÄÎ°ú Ïã§ÌñâÎê† ÏùºÎ†®Ïùò taskÎì§ÏùÑ ÎÇòÌÉÄÎÉÑ
      steps:
    # uses ÌÇ§ÏõåÎìúÎ•º ÌÜµÌï¥ Github ActionsÏóêÏÑú Í∏∞Î≥∏ÏúºÎ°ú Ï†úÍ≥µÌïòÎäî Ïï°ÏÖòÏùÑ ÏÇ¨Ïö© Í∞ÄÎä•. ÏïÑÎûò Ïï°ÏÖòÏùÄ repository Ïóê Ï≤¥ÌÅ¨ÏïÑÏõÉÌïòÎäî Í≤É
      - uses: actions/checkout@v2
      - name: GoogleServieInfomake
        run: |
          echo "CLIENT_ID=$CLIENT_ID" >> GoogleServieInfo.plist
          echo "REVERSED_CLIENT_ID=$REVERSED_CLIENT_ID" >> GoogleServieInfo.plist
          echo "API_KEY=$API_KEY" >> GoogleServieInfo.plist
          echo "GCM_SENDER_ID=$GCM_SENDER_ID" >> GoogleServieInfo.plist
          echo "PLIST_VERSION=$PLIST_VERSION" >> GoogleServieInfo.plist
          echo "BUNDLE_ID=$BUNDLE_ID" >> GoogleServieInfo.plist
          echo "PROJECT_ID=$PROJECT_ID" >> GoogleServieInfo.plist
          echo "STORAGE_BUCKET=$STORAGE_BUCKET" >> GoogleServieInfo.plist
          echo "IS_ADS_ENABLED=$IS_ADS_ENABLED" >> GoogleServieInfo.plist
          echo "IS_ANALYTICS_ENABLED=$IS_ANALYTICS_ENABLED" >> GoogleServieInfo.plist
          echo "IS_APPINVITE_ENABLED=$IS_APPINVITE_ENABLED" >> GoogleServieInfo.plist
          echo "IS_GCM_ENABLED=$IS_GCM_ENABLED" >> GoogleServieInfo.plist
          echo "IS_SIGNIN_ENABLED=$IS_SIGNIN_ENABLED" >> GoogleServieInfo.plist
          echo "GOOGLE_APP_ID=$GOOGLE_APP_ID" >> GoogleServieInfo.plist
        env:
          CLIENT_ID: ${{ secrets.CLIENT_ID}}
          REVERSED_CLIENT_ID: ${{ secrets.REVERSED_CLIENT_ID}}
          API_KEY: ${{ secrets.API_KEY}}
          GCM_SENDER_ID: ${{ secrets.GCM_SENDER_ID}}
          PLIST_VERSION: ${{ secrets.PLIST_VERSION}}
          BUNDLE_ID: ${{ secrets.BUNDLE_ID}}
          PROJECT_ID: ${{ secrets.PROJECT_ID}}
          STORAGE_BUCKET: ${{ secrets.STORAGE_BUCKET}}
          IS_ADS_ENABLED: ${{ secrets.IS_ADS_ENABLED}}
          IS_ANALYTICS_ENABLED: ${{ secrets.IS_ANALYTICS_ENABLED}}
          IS_APPINVITE_ENABLED: ${{ secrets.IS_APPINVITE_ENABLED}}
          IS_GCM_ENABLED: ${{ secrets.IS_GCM_ENABLED}}
          IS_SIGNIN_ENABLED: ${{ secrets.IS_SIGNIN_ENABLED}}
          GOOGLE_APP_ID: ${{ secrets.GOOGLE_APP_ID}}
    
    
    # shell Ïù¥Ïö©Ìï¥ÏÑú ÌïòÎÇòÏùò command ÏàòÌñâ
      - name: Start xcode build üõ†
        run: |
          xcodebuild build -project GithubCanvanPrac/GithubCanvanPrac.xcodeproj -scheme GithubCanvanPrac -destination 'platform=iOS Simulator,name=iPhone 13 Pro Max'
